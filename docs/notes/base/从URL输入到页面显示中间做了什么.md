---
title: 从URL输入到页面显示中间做了什么
---

## 前言
从URL输入到页面显示中间做了什么？可以简要分为以下几个步骤：

1. DNS 解析:将域名解析成 IP 地址
2. TCP 连接：TCP 三次握手
3. 发送 HTTP 请求
4. 服务器处理请求并返回 HTTP 报文
5. 浏览器解析渲染页面
6. 断开连接：TCP 四次挥手

## DNS 解析

### 什么是 NDS 解析
因为浏览器并不能直接通过域名找到对应的服务器，而是要通过 IP 地址。所以要根据域名查找
相对应的 IP，这个过程成为 DNS 解析。

### 为什么要有域名
IP 地址通常用“点分十进制”表示成（ a.b.c.d ）的形式，其中 a,b,c,d 都是 0~255 之
间的十进制整数，因为与 IP 地址的一组纯数字相比，用字母配合数字的表示形式来指定计算机
名更符合人类的记忆习惯，所以就域名的存在，进而就有 DNS 解析。

### DNS 解析过程
在查询过程，会按照浏览器、 操作系统、 路由、 ISP （ 互联网服务提供商 ） 的 DNS 服
务器、 根服务器的顺序进行查找，如在某个阶段已经查找到，就不往下查找了。

## TCP 连接
我们前端所需资源会通过 HTTP 进行请求，HTTP 是基于 TCP 的，一旦 TCP 建立起了连接，
在一定的时间内可以发起多次的 HTTP 请求，直到 TCP 断开连接。

![image](https://gitee.com/liulijian/picture/raw/d3a8c4ca9fdbb4111b91fa17a21c3bf24b1d87fe/other/tcp/tcp-3%E6%AC%A1%E6%8F%A1%E6%89%8B%E4%B8%8E4%E6%AC%A1%E6%8C%A5%E6%89%8B.png)

### 为什么要进行三次握手
《计算机网络》一书中讲三次握手的目的是为了解决网络中存在延迟的重复分组的问题；

在网络层进行传输会存在延迟的问题，引发服务器资源浪费。假设现在 TCP 的连接不使用三次
握手且网络延迟比较严重，当客户端发起一个请求连接，服务端在过较长的时间之后才收到这个
请求，服务器认为该请求是一个新的请求，就向客户端发起确认请求，这时就建立连接，而现在
客户端并没有发出新的连接请求，服务端就在等待。

总结：由于信道不可靠，三次握手是在不可靠信道上可靠地传输信息。

### 为什么要进行四次挥手
主要是要保证数据传输完整，只有传输结束之后才关闭连接

## 发送 HTTP 请求与服务器处理请求并返回 HTTP 报文

在 TCP 连接建立之后，就可以发送 HTTP 请求，这些请求包括了静态资源与接口请求。对应
请求的服务器会响应该 HTTP 的请求，返回对应的静态资源与接口请求的数据。

http状态码分为5个大类

* 1** 信息相关
* 2** 请求成功
* 3** 重定向相关
* 4** 客户端错误相关，或无法完成请求
* 5** 服务端错误相关

## 浏览器解析渲染页面
浏览器渲染页面是一个从上至下的过程，当拿到 html 以后首先会生成 dom 树，加载解析
css 构建 css 树，解析 css 的时候不会阻塞进程，我们通常会把首屏样式放到 head 里
面，然后加载执行 js，在js里面可能会有动态创建修改 dom 的逻辑，浏览器为了优化整个
渲染过程，会在解析到 js 的时候阻塞整个进程，我们通常把 js 放到 body 后面来优化
首屏的加载速度，当 dom 以及css 树都构建完成后会生成渲染树，再根据渲染树将 dom 
树上的节点布局到屏幕上的正确位置，最后遍历绘制的所有节点，为其添加对应的样式。

总结：

1. 根据 HTML 解析出 DOM 树
2. 根据 CSS 解析生成 CSS 规则树
3. 结合 DOM 树和 CSS 规则树，生成渲染树
4. 根据渲染树计算每一个节点的信息
5. 根据计算好的信息绘制页面
## 参考
[通俗易懂地讲解TCP建立连接的三次握手和释放连接的四次挥手](https://www.cnblogs.com/xiaoming0601/p/6001021.html)

[半月刊 2前端高频面试题及答案汇总](https://juejin.im/post/5c7bd72ef265da2de80f7f17)

[从URL输入到页面展现到底发生什么？](https://juejin.im/post/5bf3ad55f265da61682afc9b)
